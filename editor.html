<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í¸ì§‘ - ì‡¼ì¸  í€µì—ë””í„°</title>
    <link rel="stylesheet" href="css/editor.css">
</head>
<body>
    <!-- ìƒë‹¨ ë‚´ë¹„ê²Œì´ì…˜ -->
    <div id="navbar">
        <button onclick="goHome()">ğŸ  í™ˆ</button>
        <button onclick="openAdmin()">âš™ï¸ ê´€ë¦¬ì</button>
        <button onclick="saveProject()">ğŸ’¾ ì €ì¥</button>
        <div id="project-title">í”„ë¡œì íŠ¸: í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸</div>
    </div>
    
    <!-- ë©”ì¸ í¸ì§‘ ì˜ì—­ -->
    <div id="main-editor">
        <!-- ìº”ë²„ìŠ¤ ì˜ì—­ -->
        <div id="canvas-area">
            <!-- ëª¨ë“œ ì „í™˜ ë²„íŠ¼ -->
            <div class="mode-controls">
                <button id="edit-mode-btn" class="mode-btn active" onclick="switchToEditMode()">
                    âœï¸ í¸ì§‘ ëª¨ë“œ
                </button>
                <button id="player-mode-btn" class="mode-btn" onclick="switchToPlayerMode()">
                    â–¶ï¸ í”Œë ˆì´ì–´ ëª¨ë“œ
                </button>
            </div>
            
            <!-- ìº”ë²„ìŠ¤ -->
            <div id="canvas" ondrop="dropOnCanvas(event)" ondragover="allowDrop(event)">
                <!-- í¸ì§‘ ìš”ì†Œë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë¨ -->
            </div>
            
            <!-- í”Œë ˆì´ì–´ ì»¨íŠ¸ë¡¤ -->
            <div id="player-controls" class="player-controls">
                <!-- ë©”ì¸ ì»¨íŠ¸ë¡¤ ë°” -->
                <div class="control-bar">
                    <button id="play-pause-btn" class="play-btn" onclick="togglePlayPause()">â–¶ï¸</button>
                    <button class="stop-btn" onclick="stopPlayback()">â¹ï¸</button>
                    <div id="time-display" class="time-display">00:00 / 01:00</div>
                </div>
                
                <!-- íƒ€ì„ë¼ì¸ -->
                <div class="timeline-container">
                    <input type="range" id="timeline-slider" class="timeline-slider" 
                           min="0" max="60" value="0" oninput="seekTo(this.value)">
                    <select id="speed-control" class="speed-control" onchange="changePlaybackSpeed(this.value)">
                        <option value="0.5">0.5x</option>
                        <option value="1" selected>1.0x</option>
                        <option value="1.5">1.5x</option>
                        <option value="2">2.0x</option>
                    </select>
                </div>
                
                <!-- ë³¼ë¥¨ ì»¨íŠ¸ë¡¤ -->
                <div class="volume-container">
                    <span style="color: white;">ğŸ”Š</span>
                    <input type="range" id="volume-slider" class="volume-slider" 
                           min="0" max="100" value="80" oninput="changeVolume(this.value)">
                    <span id="volume-value" class="volume-value">80%</span>
                </div>
                
                <!-- í”Œë ˆì´ì–´ ì˜µì…˜ -->
                <div class="player-options">
                    <button id="loop-btn" class="option-btn" onclick="toggleLoop()">ğŸ”„ ë°˜ë³µ</button>
                    <button class="option-btn" onclick="toggleFullscreen()">â›¶ ì „ì²´í™”ë©´</button>
                    <button class="option-btn render-btn" onclick="renderVideo()">ğŸ¬ ë Œë”ë§</button>
                </div>
            </div>
        </div>
        
        <!-- PPT í¸ì§‘ê¸° -->
        <div id="ppt-editor">
            <div id="ppt-header">ğŸ¨ í¸ì§‘ ë„êµ¬</div>
            
            <!-- í¸ì§‘ê¸° íƒ­ -->
            <div id="editor-tabs">
                <button class="editor-tab active" onclick="switchEditorTab('basic')">ê¸°ë³¸</button>
                <button class="editor-tab" onclick="switchEditorTab('text')">í…ìŠ¤íŠ¸</button>
                <button class="editor-tab" onclick="switchEditorTab('image')">ì´ë¯¸ì§€</button>
                <button class="editor-tab" onclick="switchEditorTab('shape')">ë„í˜•</button>
                <button class="editor-tab" onclick="switchEditorTab('video')">ë™ì˜ìƒ</button>
                <button class="editor-tab" onclick="switchEditorTab('audio')">ìŒì„±</button>
            </div>
            
            <div id="ppt-content">
                <!-- ê¸°ë³¸ íƒ­ -->
                <div id="basic-tab" class="editor-tab-content active">
                    <div class="ppt-section">
                        <h4>ìš”ì†Œ ì¶”ê°€</h4>
                        <div class="button-group">
                            <button onclick="addQuickText()">ğŸ“ í…ìŠ¤íŠ¸</button>
                            <button onclick="addQuickImage()">ğŸ–¼ï¸ ì´ë¯¸ì§€</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="addQuickShape('circle')">â­• ì›</button>
                            <button onclick="addQuickShape('rectangle')">â¬œ ì‚¬ê°í˜•</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="addQuickVideo()">ğŸ¬ ë™ì˜ìƒ</button>
                            <button onclick="addQuickAudio()">ğŸµ ìŒì„±</button>
                        </div>
                    </div>

                    <div class="ppt-section">
                        <h4>ë°°ê²½</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px; margin-bottom: 10px;">
                            <button onclick="changeBackground('#000000')" style="background: #000; color: white; padding: 8px; border: none; border-radius: 4px; cursor: pointer;">âš«</button>
                            <button onclick="changeBackground('#ffffff')" style="background: #fff; color: #000; padding: 8px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer;">âšª</button>
                            <button onclick="changeBackground('linear-gradient(135deg, #667eea 0%, #764ba2 100%)')" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 8px; border: none; border-radius: 4px; cursor: pointer;">ğŸŒ…</button>
                            <button onclick="changeBackground('linear-gradient(135deg, #f093fb 0%, #f5576c 100%)')" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 8px; border: none; border-radius: 4px; cursor: pointer;">ğŸŒº</button>
                        </div>
                        <div class="ppt-control">
                            <label>ì»¤ìŠ¤í…€ ìƒ‰ìƒ</label>
                            <input type="color" id="bg-color" onchange="changeBackground(this.value)" value="#667eea">
                        </div>
                    </div>

                    <div class="ppt-section">
                        <h4>ìº”ë²„ìŠ¤ ì„¤ì •</h4>
                        <div class="button-group">
                            <button onclick="clearCanvas()">ğŸ—‘ï¸ ì „ì²´ì‚­ì œ</button>
                            <button onclick="resetCanvas()">â†©ï¸ ì´ˆê¸°í™”</button>
                        </div>
                        <div class="ppt-control" style="margin-top: 10px;">
                            <label>í™•ëŒ€/ì¶•ì†Œ</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <button onclick="zoomOut()" style="padding: 5px 10px; background: #555; border: none; color: white; border-radius: 3px; cursor: pointer;">â–</button>
                                <span id="zoom-level" style="color: #ccc; min-width: 50px; text-align: center;">100%</span>
                                <button onclick="zoomIn()" style="padding: 5px 10px; background: #555; border: none; color: white; border-radius: 3px; cursor: pointer;">â•</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- í…ìŠ¤íŠ¸ íƒ­ -->
                <div id="text-tab" class="editor-tab-content">
                    <div class="ppt-section">
                        <h4>í…ìŠ¤íŠ¸ ì¶”ê°€</h4>
                        <div class="button-group">
                            <button onclick="addQuickText()">ğŸ“ í…ìŠ¤íŠ¸ ì¶”ê°€</button>
                        </div>
                    </div>
                    
                    <div class="ppt-section">
                        <h4>ğŸ“ í…ìŠ¤íŠ¸ í¸ì§‘</h4>
                        <div class="ppt-control">
                            <label>í…ìŠ¤íŠ¸ ë‚´ìš©</label>
                            <textarea id="text-content" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" 
                                     oninput="syncTextContent()"
                                     style="width: 100%; height: 60px; padding: 8px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white; resize: vertical;"></textarea>
                        </div>
                        
                        <div class="ppt-control">
                            <label>í°íŠ¸ í¬ê¸°</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="text-font-size" min="12" max="48" value="16" 
                                       oninput="updateTextFontSize(this.value)" style="flex: 1;">
                                <span id="text-font-size-value" style="min-width: 40px; color: #ccc;">16px</span>
                            </div>
                        </div>
                        
                        <div class="ppt-control">
                            <label>í…ìŠ¤íŠ¸ ë°•ìŠ¤ ë„ˆë¹„</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="text-width" min="50" max="280" value="150" 
                                       oninput="updateTextWidth(this.value)" style="flex: 1;">
                                <span id="text-width-value" style="min-width: 50px; color: #ccc;">150px</span>
                            </div>
                        </div>
                        
                        <div class="ppt-control">
                            <label>í…ìŠ¤íŠ¸ ë°•ìŠ¤ ë†’ì´</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="text-height" min="30" max="200" value="50" 
                                       oninput="updateTextHeight(this.value)" style="flex: 1;">
                                <span id="text-height-value" style="min-width: 50px; color: #ccc;">50px</span>
                            </div>
                        </div>
                        
                        <div class="ppt-control">
                            <label>ê¸€ì ìƒ‰ìƒ</label>
                            <input type="color" id="text-color" value="#ffffff" 
                                   onchange="updateTextColor(this.value)" style="width: 100%; height: 30px;">
                        </div>
                        
                        <div class="ppt-control">
                            <label>ë°°ê²½ ìƒ‰ìƒ</label>
                            <input type="color" id="text-bg-color" value="#000000" 
                                   onchange="updateTextBgColor(this.value)" style="width: 100%; height: 30px;">
                        </div>
                        
                        <div class="button-group">
                            <button id="text-bold-btn" onclick="toggleTextBold()">B</button>
                            <button id="text-italic-btn" onclick="toggleTextItalic()">I</button>
                            <button id="text-underline-btn" onclick="toggleTextUnderline()">U</button>
                        </div>
                        
                        <div class="ppt-control">
                            <label>ìœ„ì¹˜ ì¡°ì •</label>
                            <div style="display: flex; gap: 10px;">
                                <div style="flex: 1;">
                                    <label style="font-size: 10px;">X</label>
                                    <input type="number" id="text-x" min="0" max="300" 
                                           onchange="updateTextPosition()" 
                                           style="width: 100%; padding: 4px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white;">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 10px;">Y</label>
                                    <input type="number" id="text-y" min="0" max="500" 
                                           onchange="updateTextPosition()" 
                                           style="width: 100%; padding: 4px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white;">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ë ˆì´ì–´ ê´€ë¦¬ (í…ìŠ¤íŠ¸ìš©) -->
                    <div class="ppt-section">
                        <h4>ë ˆì´ì–´ ê´€ë¦¬</h4>
                        <div class="button-group">
                            <button onclick="bringToFront()">ğŸ”¼ ë§¨ì•ìœ¼ë¡œ</button>
                            <button onclick="sendToBack()">ğŸ”½ ë§¨ë’¤ë¡œ</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="moveForward()">â¬†ï¸ ì•ìœ¼ë¡œ</button>
                            <button onclick="moveBackward()">â¬‡ï¸ ë’¤ë¡œ</button>
                        </div>
                    </div>

                    <!-- ì •ë ¬ ë„êµ¬ (í…ìŠ¤íŠ¸ìš©) -->
                    <div class="ppt-section">
                        <h4>ì •ë ¬</h4>
                        <div class="button-group">
                            <button onclick="alignLeft()">â¬…ï¸ ì™¼ìª½</button>
                            <button onclick="alignCenter()">â†”ï¸ ê°€ìš´ë°</button>
                            <button onclick="alignRight()">â¡ï¸ ì˜¤ë¥¸ìª½</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="alignTop()">â¬†ï¸ ìœ„</button>
                            <button onclick="alignMiddle()">â†•ï¸ ì¤‘ê°„</button>
                            <button onclick="alignBottom()">â¬‡ï¸ ì•„ë˜</button>
                        </div>
                    </div>
                    
                    <!-- ì„ íƒëœ ìš”ì†Œ ê´€ë¦¬ (í…ìŠ¤íŠ¸ìš©) -->
                    <div class="ppt-section">
                        <h4>ì„ íƒëœ ìš”ì†Œ</h4>
                        <div class="button-group">
                            <button onclick="duplicateElement()">ğŸ”„ ë³µì œ</button>
                            <button onclick="deleteSelectedElement()">ğŸ—‘ï¸ ì‚­ì œ</button>
                        </div>
                    </div>
                </div>

                <!-- ì´ë¯¸ì§€ íƒ­ -->
                <div id="image-tab" class="editor-tab-content">
                    <div class="ppt-section">
                        <h4>ì´ë¯¸ì§€ ì¶”ê°€</h4>
                        <div class="button-group">
                            <button onclick="addQuickImage()">ğŸ–¼ï¸ ì´ë¯¸ì§€ ì¶”ê°€</button>
                        </div>
                    </div>
                    
                    <div class="ppt-section">
                        <h4>ğŸ–¼ï¸ ì´ë¯¸ì§€ í¸ì§‘</h4>
                        <div class="ppt-control">
                            <label>ë„ˆë¹„</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="image-width" min="50" max="280" value="150" 
                                       oninput="updateImageWidth(this.value)" style="flex: 1;">
                                <span id="image-width-value" style="min-width: 50px; color: #ccc;">150px</span>
                            </div>
                        </div>
                        <div class="ppt-control">
                            <label>ë†’ì´</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="image-height" min="50" max="450" value="150" 
                                       oninput="updateImageHeight(this.value)" style="flex: 1;">
                                <span id="image-height-value" style="min-width: 50px; color: #ccc;">150px</span>
                            </div>
                        </div>
                        <div class="button-group">
                            <button id="lock-ratio-btn" onclick="toggleAspectRatio()">ğŸ”’ ë¹„ìœ¨ê³ ì •</button>
                            <button onclick="resetImageSize()">â†©ï¸ ì›ë˜í¬ê¸°</button>
                        </div>
                        
                        <div class="ppt-control">
                            <label>ìœ„ì¹˜ ì¡°ì •</label>
                            <div style="display: flex; gap: 10px;">
                                <div style="flex: 1;">
                                    <label style="font-size: 10px;">X</label>
                                    <input type="number" id="image-x" min="0" max="300" 
                                           onchange="updateImagePosition()" 
                                           style="width: 100%; padding: 4px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white;">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 10px;">Y</label>
                                    <input type="number" id="image-y" min="0" max="500" 
                                           onchange="updateImagePosition()" 
                                           style="width: 100%; padding: 4px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white;">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="ppt-section">
                        <h4>ì´ë¯¸ì§€ íš¨ê³¼</h4>
                        <div class="ppt-control">
                            <label>íˆ¬ëª…ë„</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="image-opacity" min="0" max="100" value="100" 
                                       oninput="updateImageOpacity(this.value)" style="flex: 1;">
                                <span id="image-opacity-value" style="min-width: 40px; color: #ccc;">100%</span>
                            </div>
                        </div>
                        <div class="ppt-control">
                            <label>íšŒì „</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="image-rotation" min="0" max="360" value="0" 
                                       oninput="updateImageRotation(this.value)" style="flex: 1;">
                                <span id="image-rotation-value" style="min-width: 40px; color: #ccc;">0Â°</span>
                            </div>
                        </div>
                        <div class="button-group">
                            <button onclick="flipImageH()">â†”ï¸ ì¢Œìš°ë’¤ì§‘ê¸°</button>
                            <button onclick="flipImageV()">â†•ï¸ ìƒí•˜ë’¤ì§‘ê¸°</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="rotateImage(90)">â†» 90Â° íšŒì „</button>
                            <button onclick="rotateImage(-90)">â†º -90Â° íšŒì „</button>
                        </div>
                    </div>
                    
                    <div class="ppt-section">
                        <h4>ì´ë¯¸ì§€ í•„í„°</h4>
                        <div class="button-group">
                            <button onclick="applyImageFilter('none')">ğŸ”„ ì›ë³¸</button>
                            <button onclick="applyImageFilter('grayscale')">âš« í‘ë°±</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="applyImageFilter('sepia')">ğŸŸ¤ ì„¸í”¼ì•„</button>
                            <button onclick="applyImageFilter('blur')">ğŸŒ«ï¸ ë¸”ëŸ¬</button>
                        </div>
                    </div>
                    
                    <!-- ë ˆì´ì–´ ê´€ë¦¬ (ì´ë¯¸ì§€ìš©) -->
                    <div class="ppt-section">
                        <h4>ë ˆì´ì–´ ê´€ë¦¬</h4>
                        <div class="button-group">
                            <button onclick="bringToFront()">ğŸ”¼ ë§¨ì•ìœ¼ë¡œ</button>
                            <button onclick="sendToBack()">ğŸ”½ ë§¨ë’¤ë¡œ</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="moveForward()">â¬†ï¸ ì•ìœ¼ë¡œ</button>
                            <button onclick="moveBackward()">â¬‡ï¸ ë’¤ë¡œ</button>
                        </div>
                    </div>

                    <!-- ì •ë ¬ ë„êµ¬ (ì´ë¯¸ì§€ìš©) -->
                    <div class="ppt-section">
                        <h4>ì •ë ¬</h4>
                        <div class="button-group">
                            <button onclick="alignLeft()">â¬…ï¸ ì™¼ìª½</button>
                            <button onclick="alignCenter()">â†”ï¸ ê°€ìš´ë°</button>
                            <button onclick="alignRight()">â¡ï¸ ì˜¤ë¥¸ìª½</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="alignTop()">â¬†ï¸ ìœ„</button>
                            <button onclick="alignMiddle()">â†•ï¸ ì¤‘ê°„</button>
                            <button onclick="alignBottom()">â¬‡ï¸ ì•„ë˜</button>
                        </div>
                    </div>
                    
                    <!-- ì„ íƒëœ ìš”ì†Œ ê´€ë¦¬ (ì´ë¯¸ì§€ìš©) -->
                    <div class="ppt-section">
                        <h4>ì„ íƒëœ ìš”ì†Œ</h4>
                        <div class="button-group">
                            <button onclick="duplicateElement()">ğŸ”„ ë³µì œ</button>
                            <button onclick="deleteSelectedElement()">ğŸ—‘ï¸ ì‚­ì œ</button>
                        </div>
                    </div>
                </div>

                <!-- ë„í˜• íƒ­ -->
                <div id="shape-tab" class="editor-tab-content">
                    <div class="ppt-section">
                        <h4>ë„í˜• ì¶”ê°€</h4>
                        <div class="button-group">
                            <button onclick="addQuickShape('circle')">â­• ì› ì¶”ê°€</button>
                            <button onclick="addQuickShape('rectangle')">â¬œ ì‚¬ê°í˜• ì¶”ê°€</button>
                        </div>
                    </div>
                    
                    <div class="ppt-section">
                        <h4>ğŸ”º ë„í˜• í¸ì§‘</h4>
                        
                        <div class="ppt-control">
                            <label>ë„í˜• ë„ˆë¹„</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="shape-width" min="20" max="280" value="120" 
                                       oninput="updateShapeWidth(this.value)" style="flex: 1;">
                                <span id="shape-width-value" style="min-width: 50px; color: #ccc;">120px</span>
                            </div>
                        </div>
                        
                        <div class="ppt-control">
                            <label>ë„í˜• ë†’ì´</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="shape-height" min="20" max="200" value="80" 
                                       oninput="updateShapeHeight(this.value)" style="flex: 1;">
                                <span id="shape-height-value" style="min-width: 50px; color: #ccc;">80px</span>
                            </div>
                        </div>
                        
                        <div class="button-group">
                            <button id="shape-lock-ratio-btn" onclick="toggleShapeAspectRatio()">ğŸ”’ ë¹„ìœ¨ê³ ì •</button>
                            <button onclick="resetShapeSize()">â†©ï¸ ì›ë˜í¬ê¸°</button>
                        </div>
                        
                        <div class="ppt-control">
                            <label>ìœ„ì¹˜ ì¡°ì •</label>
                            <div style="display: flex; gap: 10px;">
                                <div style="flex: 1;">
                                    <label style="font-size: 10px;">X</label>
                                    <input type="number" id="shape-x" min="0" max="300" 
                                           onchange="updateShapePosition()" 
                                           style="width: 100%; padding: 4px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white;">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 10px;">Y</label>
                                    <input type="number" id="shape-y" min="0" max="500" 
                                           onchange="updateShapePosition()" 
                                           style="width: 100%; padding: 4px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white;">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="ppt-section">
                        <h4>ë„í˜• ìŠ¤íƒ€ì¼</h4>
                        <div class="ppt-control">
                            <label>ë°°ê²½ ìƒ‰ìƒ</label>
                            <input type="color" id="shape-bg-color" value="#667eea" 
                                   onchange="updateShapeBgColor(this.value)" style="width: 100%; height: 30px;">
                        </div>
                        
                        <div class="ppt-control">
                            <label>í…Œë‘ë¦¬ ìƒ‰ìƒ</label>
                            <input type="color" id="shape-border-color" value="#333333" 
                                   onchange="updateShapeBorderColor(this.value)" style="width: 100%; height: 30px;">
                        </div>
                        
                        <div class="ppt-control">
                            <label>í…Œë‘ë¦¬ ë‘ê»˜</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="shape-border-width" min="0" max="10" value="0" 
                                       oninput="updateShapeBorderWidth(this.value)" style="flex: 1;">
                                <span id="shape-border-width-value" style="min-width: 40px; color: #ccc;">0px</span>
                            </div>
                        </div>
                        
                        <div class="ppt-control">
                            <label>íˆ¬ëª…ë„</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="shape-opacity" min="0" max="100" value="100" 
                                       oninput="updateShapeOpacity(this.value)" style="flex: 1;">
                                <span id="shape-opacity-value" style="min-width: 40px; color: #ccc;">100%</span>
                            </div>
                        </div>
                        
                        <div class="ppt-control">
                            <label>íšŒì „</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="shape-rotation" min="0" max="360" value="0" 
                                       oninput="updateShapeRotation(this.value)" style="flex: 1;">
                                <span id="shape-rotation-value" style="min-width: 40px; color: #ccc;">0Â°</span>
                            </div>
                        </div>
                        
                        <div class="button-group">
                            <button onclick="rotateShape(90)">â†» 90Â° íšŒì „</button>
                            <button onclick="rotateShape(-90)">â†º -90Â° íšŒì „</button>
                        </div>
                    </div>
                    
                    <!-- ë ˆì´ì–´ ê´€ë¦¬ (ë„í˜•ìš©) -->
                    <div class="ppt-section">
                        <h4>ë ˆì´ì–´ ê´€ë¦¬</h4>
                        <div class="button-group">
                            <button onclick="bringToFront()">ğŸ”¼ ë§¨ì•ìœ¼ë¡œ</button>
                            <button onclick="sendToBack()">ğŸ”½ ë§¨ë’¤ë¡œ</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="moveForward()">â¬†ï¸ ì•ìœ¼ë¡œ</button>
                            <button onclick="moveBackward()">â¬‡ï¸ ë’¤ë¡œ</button>
                        </div>
                    </div>

                    <!-- ì •ë ¬ ë„êµ¬ (ë„í˜•ìš©) -->
                    <div class="ppt-section">
                        <h4>ì •ë ¬</h4>
                        <div class="button-group">
                            <button onclick="alignLeft()">â¬…ï¸ ì™¼ìª½</button>
                            <button onclick="alignCenter()">â†”ï¸ ê°€ìš´ë°</button>
                            <button onclick="alignRight()">â¡ï¸ ì˜¤ë¥¸ìª½</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="alignTop()">â¬†ï¸ ìœ„</button>
                            <button onclick="alignMiddle()">â†•ï¸ ì¤‘ê°„</button>
                            <button onclick="alignBottom()">â¬‡ï¸ ì•„ë˜</button>
                        </div>
                    </div>
                    
                    <!-- ì„ íƒëœ ìš”ì†Œ ê´€ë¦¬ (ë„í˜•ìš©) -->
                    <div class="ppt-section">
                        <h4>ì„ íƒëœ ìš”ì†Œ</h4>
                        <div class="button-group">
                            <button onclick="duplicateElement()">ğŸ”„ ë³µì œ</button>
                            <button onclick="deleteSelectedElement()">ğŸ—‘ï¸ ì‚­ì œ</button>
                        </div>
                    </div>
                </div>

                <!-- ë™ì˜ìƒ íƒ­ -->
                <div id="video-tab" class="editor-tab-content">
                    <div class="ppt-section">
                        <h4>ë™ì˜ìƒ ì¶”ê°€</h4>
                        <div class="button-group">
                            <button onclick="addQuickVideo()">ğŸ¬ ë™ì˜ìƒ ì¶”ê°€</button>
                        </div>
                    </div>
                    
                    <div class="ppt-section">
                        <h4>ğŸ¬ ë™ì˜ìƒ í¸ì§‘</h4>
                        <div class="ppt-control">
                            <label>ë™ì˜ìƒ í¬ê¸°</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="video-scale" min="50" max="200" value="100" 
                                       oninput="updateVideoScale(this.value)" style="flex: 1;">
                                <span id="video-scale-value" style="min-width: 50px; color: #ccc;">100%</span>
                            </div>
                        </div>
                        
                        <div class="ppt-control">
                            <label>ì¬ìƒ ì†ë„</label>
                            <select id="video-speed" onchange="updateVideoSpeed(this.value)" style="width: 100%; padding: 8px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white;">
                                <option value="0.5">0.5ë°°ì†</option>
                                <option value="1" selected>1.0ë°°ì†</option>
                                <option value="1.5">1.5ë°°ì†</option>
                                <option value="2">2.0ë°°ì†</option>
                            </select>
                        </div>
                        
                        <div class="button-group">
                            <button onclick="muteVideo()">ğŸ”‡ ìŒì†Œê±°</button>
                            <button onclick="loopVideo()">ğŸ”„ ë°˜ë³µì¬ìƒ</button>
                        </div>
                        
                        <div class="ppt-control">
                            <label>ë™ì˜ìƒ ìœ„ì¹˜</label>
                            <div style="display: flex; gap: 10px;">
                                <div style="flex: 1;">
                                    <label style="font-size: 10px;">X</label>
                                    <input type="number" id="video-x" min="0" max="300" 
                                           onchange="updateVideoPosition()" 
                                           style="width: 100%; padding: 4px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white;">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 10px;">Y</label>
                                    <input type="number" id="video-y" min="0" max="500" 
                                           onchange="updateVideoPosition()" 
                                           style="width: 100%; padding: 4px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white;">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ë ˆì´ì–´ ê´€ë¦¬ (ë™ì˜ìƒìš©) -->
                    <div class="ppt-section">
                        <h4>ë ˆì´ì–´ ê´€ë¦¬</h4>
                        <div class="button-group">
                            <button onclick="bringToFront()">ğŸ”¼ ë§¨ì•ìœ¼ë¡œ</button>
                            <button onclick="sendToBack()">ğŸ”½ ë§¨ë’¤ë¡œ</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="moveForward()">â¬†ï¸ ì•ìœ¼ë¡œ</button>
                            <button onclick="moveBackward()">â¬‡ï¸ ë’¤ë¡œ</button>
                        </div>
                    </div>

                    <!-- ì •ë ¬ ë„êµ¬ (ë™ì˜ìƒìš©) -->
                    <div class="ppt-section">
                        <h4>ì •ë ¬</h4>
                        <div class="button-group">
                            <button onclick="alignLeft()">â¬…ï¸ ì™¼ìª½</button>
                            <button onclick="alignCenter()">â†”ï¸ ê°€ìš´ë°</button>
                            <button onclick="alignRight()">â¡ï¸ ì˜¤ë¥¸ìª½</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="alignTop()">â¬†ï¸ ìœ„</button>
                            <button onclick="alignMiddle()">â†•ï¸ ì¤‘ê°„</button>
                            <button onclick="alignBottom()">â¬‡ï¸ ì•„ë˜</button>
                        </div>
                    </div>
                    
                    <!-- ì„ íƒëœ ìš”ì†Œ ê´€ë¦¬ (ë™ì˜ìƒìš©) -->
                    <div class="ppt-section">
                        <h4>ì„ íƒëœ ìš”ì†Œ</h4>
                        <div class="button-group">
                            <button onclick="duplicateElement()">ğŸ”„ ë³µì œ</button>
                            <button onclick="deleteSelectedElement()">ğŸ—‘ï¸ ì‚­ì œ</button>
                        </div>
                    </div>
                </div>

                <!-- ìŒì„± íƒ­ -->
                <div id="audio-tab" class="editor-tab-content">
                    <div class="ppt-section">
                        <h4>ìŒì„± ì¶”ê°€</h4>
                        <div class="button-group">
                            <button onclick="addQuickAudio()">ğŸµ ìŒì„± ì¶”ê°€</button>
                        </div>
                    </div>
                    
                    <div class="ppt-section">
                        <h4>ğŸµ ìŒì„± í¸ì§‘</h4>
                        <div class="ppt-control">
                            <label>ìŒëŸ‰</label>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="range" id="audio-volume" min="0" max="100" value="80" 
                                       oninput="updateAudioVolume(this.value)" style="flex: 1;">
                                <span id="audio-volume-value" style="min-width: 40px; color: #ccc;">80%</span>
                            </div>
                        </div>
                        
                        <div class="ppt-control">
                            <label>í˜ì´ë“œ íš¨ê³¼</label>
                            <div class="button-group">
                                <button onclick="applyFadeIn()">ğŸ“ˆ í˜ì´ë“œì¸</button>
                                <button onclick="applyFadeOut()">ğŸ“‰ í˜ì´ë“œì•„ì›ƒ</button>
                            </div>
                        </div>
                        
                        <div class="ppt-control">
                            <label>ì˜¤ë””ì˜¤ í•„í„°</label>
                            <select id="audio-filter" onchange="applyAudioFilter(this.value)" style="width: 100%; padding: 8px; background: #404040; border: 1px solid #555; border-radius: 4px; color: white;">
                                <option value="none">í•„í„° ì—†ìŒ</option>
                                <option value="reverb">ë¦¬ë²„ë¸Œ</option>
                                <option value="echo">ì—ì½”</option>
                                <option value="bass">ì €ìŒ ê°•í™”</option>
                            </select>
                        </div>
                        
                        <div class="button-group">
                            <button onclick="muteAudio()">ğŸ”‡ ìŒì†Œê±°</button>
                            <button onclick="soloAudio()">ğŸ§ ì†”ë¡œ</button>
                        </div>
                    </div>
                    
                    <!-- ë ˆì´ì–´ ê´€ë¦¬ (ìŒì„±ìš©) -->
                    <div class="ppt-section">
                        <h4>ë ˆì´ì–´ ê´€ë¦¬</h4>
                        <div class="button-group">
                            <button onclick="bringToFront()">ğŸ”¼ ë§¨ì•ìœ¼ë¡œ</button>
                            <button onclick="sendToBack()">ğŸ”½ ë§¨ë’¤ë¡œ</button>
                        </div>
                        <div class="button-group" style="margin-top: 5px;">
                            <button onclick="moveForward()">â¬†ï¸ ì•ìœ¼ë¡œ</button>
                            <button onclick="moveBackward()">â¬‡ï¸ ë’¤ë¡œ</button>
                        </div>
                    </div>
                    
                    <!-- ì„ íƒëœ ìš”ì†Œ ê´€ë¦¬ (ìŒì„±ìš©) -->
                    <div class="ppt-section">
                        <h4>ì„ íƒëœ ìš”ì†Œ</h4>
                        <div class="button-group">
                            <button onclick="duplicateElement()">ğŸ”„ ë³µì œ</button>
                            <button onclick="deleteSelectedElement()">ğŸ—‘ï¸ ì‚­ì œ</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ì†ŒìŠ¤ íŒ¨ë„ -->
        <div id="source-panel">
            <div id="source-tabs">
                <button class="source-tab active" onclick="switchTab('media')">ğŸ–¼<br>ë¯¸ë””ì–´</button>
                <button class="source-tab" onclick="switchTab('text')">ğŸ“<br>í…ìŠ¤íŠ¸</button>
                <button class="source-tab" onclick="switchTab('audio')">ğŸµ<br>ìŒì„±</button>
                <button class="source-tab" onclick="switchTab('template')">ğŸ¨<br>í…œí”Œë¦¿</button>
            </div>
            
            <div id="source-content">
                <!-- ë¯¸ë””ì–´ ì†ŒìŠ¤ -->
                <div id="media-sources" class="source-section active">
                    <!-- templates/media-panel.html ë‚´ìš©ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
                
                <!-- í…ìŠ¤íŠ¸ ì†ŒìŠ¤ -->
                    <div class="source-item">
                        <div class="source-item-title">ğŸ“œ ëŒ€ë³¸ ì‘ì„±</div>
                        <div class="source-item-desc">ë™ì˜ìƒ ëŒ€ë³¸</div>
                        <div class="button-group">
                            <button onclick="showScriptEditor('manual')">ì§ì ‘ì‘ì„±</button>
                            <button onclick="showScriptEditor('ai')">AIì‘ì„±</button>
                        </div>
                    </div>
                    
                    <div class="source-item">
                        <div class="source-item-title">ğŸ™ï¸ ë‚´ë ˆì´ì…˜</div>
                        <div class="source-item-desc">ìŒì„± ëŒ€ë³¸</div>
                        <div class="button-group">
                            <button onclick="showNarrationEditor('manual')">ì§ì ‘ì‘ì„±</button>
                            <button onclick="showNarrationEditor('ai')">AIì‘ì„±</button>
                        </div>
                    </div>
                </div>
                
                <!-- ìŒì„± ì†ŒìŠ¤ -->
                <div id="audio-sources" class="source-section">
                    <!-- templates/audio-panel.html ë‚´ìš©ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
                
                <!-- í…œí”Œë¦¿ ì†ŒìŠ¤ -->
                <div id="template-sources" class="source-section">
                    <!-- templates/template-panel.html ë‚´ìš©ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- JavaScript íŒŒì¼ë“¤ ë¡œë“œ -->
    <script src="js/utils.js"></script>
    <script src="js/canvas.js"></script>
    <script src="js/navigation.js"></script>
    <script src="js/tabs.js"></script>
    <script src="js/dragdrop.js"></script>
    <script src="js/editor.js"></script>
    <script src="js/media.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/text.js"></script>
    <script src="js/template.js"></script>
    <script src="js/init.js"></script>
    
    <script>
// ì „ì—­ ë³€ìˆ˜ ì„ ì–¸
let selectedElement = null;
window.selectedElement = null;

// ìš”ì†Œ ì„ íƒ í•¨ìˆ˜
function selectElement(element) {
    // ê¸°ì¡´ ì„ íƒ í•´ì œ
    const prevSelected = document.querySelector('.canvas-element.selected');
    if (prevSelected) {
        prevSelected.classList.remove('selected');
        prevSelected.style.border = '';
    }
    
    // ìƒˆ ìš”ì†Œ ì„ íƒ
    selectedElement = element;
    window.selectedElement = element;
    
    if (element) {
        element.classList.add('selected');
        element.style.border = '2px solid #007bff';
        
        // í•´ë‹¹ íƒ­ìœ¼ë¡œ ìë™ ì „í™˜
        if (element.classList.contains('canvas-text')) {
            switchEditorTab('text');
        } else if (element.classList.contains('canvas-image')) {
            switchEditorTab('image');
        } else if (element.classList.contains('canvas-shape')) {
            switchEditorTab('shape');
        } else if (element.classList.contains('canvas-video')) {
            switchEditorTab('video');
        } else if (element.classList.contains('canvas-audio')) {
            switchEditorTab('audio');
        }
        
        console.log('ìš”ì†Œ ì„ íƒë¨:', element.className);
    }
}

// ìº”ë²„ìŠ¤ í´ë¦­ì‹œ ì„ íƒ í•´ì œ
document.getElementById('canvas').onclick = function(e) {
    if (e.target.id === 'canvas') {
        selectElement(null);
    }
};
        // ========== íƒ­ ì „í™˜ í•¨ìˆ˜ ==========
function switchEditorTab(tabName) {
    // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
    const tabs = document.querySelectorAll('.editor-tab');
    const contents = document.querySelectorAll('.editor-tab-content');
    
    tabs.forEach(tab => {
        tab.classList.remove('active');
        tab.style.backgroundColor = '#555';
        tab.style.color = '#ccc';
    });
    contents.forEach(content => content.classList.remove('active'));
    
    // ì„ íƒëœ íƒ­ í™œì„±í™”
    const selectedTab = document.querySelector(`[onclick="switchEditorTab('${tabName}')"]`);
    const selectedContent = document.getElementById(`${tabName}-tab`);
    
    if (selectedTab) {
        selectedTab.classList.add('active');
        selectedTab.style.backgroundColor = '#007bff';
        selectedTab.style.color = 'white';
    }
    if (selectedContent) selectedContent.classList.add('active');
            
            // í…ìŠ¤íŠ¸ íƒ­ìœ¼ë¡œ ì „í™˜í•  ë•Œ ì„ íƒëœ í…ìŠ¤íŠ¸ ìš”ì†Œê°€ ìˆìœ¼ë©´ í¸ì§‘ ë„êµ¬ì— ë¡œë“œ
            if (tabName === 'text' && selectedElement && selectedElement.classList.contains('canvas-text')) {
                loadTextToEditor(selectedElement);
            }
            
            console.log('í¸ì§‘ê¸° íƒ­ ì „í™˜:', tabName);
        }
        
        // ========== í…ìŠ¤íŠ¸ í¸ì§‘ í•¨ìˆ˜ë“¤ ==========
        function updateTextFontSize(size) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-text')) return;
            selectedElement.style.fontSize = size + 'px';
            document.getElementById('text-font-size-value').textContent = size + 'px';
            saveCanvasState();
        }
        
        function updateTextColor(color) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-text')) return;
            selectedElement.style.color = color;
            saveCanvasState();
        }
        
        function updateTextBgColor(color) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-text')) return;
            selectedElement.style.backgroundColor = color;
            saveCanvasState();
        }
        
        function toggleTextBold() {
            if (!selectedElement || !selectedElement.classList.contains('canvas-text')) return;
            const currentWeight = selectedElement.style.fontWeight;
            selectedElement.style.fontWeight = currentWeight === 'bold' ? 'normal' : 'bold';
            
            const btn = document.getElementById('text-bold-btn');
            if (btn) {
                btn.classList.toggle('active');
            }
            saveCanvasState();
        }
        
        function toggleTextItalic() {
            if (!selectedElement || !selectedElement.classList.contains('canvas-text')) return;
            const currentStyle = selectedElement.style.fontStyle;
            selectedElement.style.fontStyle = currentStyle === 'italic' ? 'normal' : 'italic';
            
            const btn = document.getElementById('text-italic-btn');
            if (btn) {
                btn.classList.toggle('active');
            }
            saveCanvasState();
        }
        
        function toggleTextUnderline() {
            if (!selectedElement || !selectedElement.classList.contains('canvas-text')) return;
            const currentDecoration = selectedElement.style.textDecoration;
            selectedElement.style.textDecoration = currentDecoration === 'underline' ? 'none' : 'underline';
            
            const btn = document.getElementById('text-underline-btn');
            if (btn) {
                btn.classList.toggle('active');
            }
            saveCanvasState();
        }
        
        // í…ìŠ¤íŠ¸ ë‚´ìš© ì‹¤ì‹œê°„ ì—°ë™
        function syncTextContent() {
            const textContent = document.getElementById('text-content');
            if (textContent && selectedElement && selectedElement.classList.contains('canvas-text')) {
                selectedElement.innerHTML = textContent.value;
                saveCanvasState();
            }
        }
        
        // ì„ íƒëœ í…ìŠ¤íŠ¸ ìš”ì†Œì˜ ê°’ì„ í¸ì§‘ ë„êµ¬ì— ë°˜ì˜
        function loadTextToEditor(element) {
            if (!element || !element.classList.contains('canvas-text')) return;
            
            const textContent = document.getElementById('text-content');
            const textColor = document.getElementById('text-color');
            const textBgColor = document.getElementById('text-bg-color');
            const textFontSize = document.getElementById('text-font-size');
            const textWidth = document.getElementById('text-width');
            const textHeight = document.getElementById('text-height');
            const textX = document.getElementById('text-x');
            const textY = document.getElementById('text-y');
            
            if (textContent) {
                textContent.value = element.textContent || element.innerHTML;
            }
            if (textColor) {
                textColor.value = rgb2hex(element.style.color) || '#ffffff';
            }
            if (textBgColor) {
                textBgColor.value = rgb2hex(element.style.backgroundColor) || '#000000';
            }
            if (textFontSize) {
                const fontSize = parseInt(element.style.fontSize) || 16;
                textFontSize.value = fontSize;
                document.getElementById('text-font-size-value').textContent = fontSize + 'px';
            }
            if (textWidth) {
                const width = parseInt(element.style.width) || 150;
                textWidth.value = width;
                document.getElementById('text-width-value').textContent = width + 'px';
            }
            if (textHeight) {
                const height = parseInt(element.style.height) || 50;
                textHeight.value = height;
                document.getElementById('text-height-value').textContent = height + 'px';
            }
            if (textX) {
                textX.value = parseInt(element.style.left) || 0;
            }
            if (textY) {
                textY.value = parseInt(element.style.top) || 0;
            }
        }
        
        // RGBë¥¼ HEXë¡œ ë³€í™˜í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
        function rgb2hex(rgb) {
            if (!rgb || rgb.indexOf("rgb") === -1) return rgb;
            
            rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
            if (!rgb) return "#000000";
            
            function hex(x) {
                return ("0" + parseInt(x).toString(16)).slice(-2);
            }
            return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
        }
        
        // ========== ìš”ì†Œ ì¶”ê°€ í•¨ìˆ˜ë“¤ ==========
        function addQuickText() {
            // í…ìŠ¤íŠ¸ ìš”ì†Œ ì¶”ê°€
            const canvas = document.getElementById('canvas');
            const textElement = document.createElement('div');
            textElement.className = 'canvas-element canvas-text';
            textElement.innerHTML = 'í…ìŠ¤íŠ¸ ì…ë ¥';
            textElement.contentEditable = true;
            textElement.style.position = 'absolute';
            textElement.style.left = '50px';
            textElement.style.top = '50px';
            textElement.style.cursor = 'move';
            
            // ë“œë˜ê·¸ ê¸°ëŠ¥ì„ ìœ„í•œ ì´ë²¤íŠ¸ ì²˜ë¦¬
            let isDragging = false;
            let startX, startY, initialX, initialY;
            
            textElement.addEventListener('mousedown', function(e) {
                // í…ìŠ¤íŠ¸ í¸ì§‘ ì¤‘ì´ ì•„ë‹ ë•Œë§Œ ë“œë˜ê·¸ ì‹œì‘
                if (!this.isContentEditable || e.ctrlKey) {
                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    initialX = parseInt(this.style.left) || 0;
                    initialY = parseInt(this.style.top) || 0;
                    this.style.cursor = 'grabbing';
                    e.preventDefault();
                }
            });
            
            document.addEventListener('mousemove', function(e) {
                if (isDragging && textElement) {
                    const deltaX = e.clientX - startX;
                    const deltaY = e.clientY - startY;
                    textElement.style.left = (initialX + deltaX) + 'px';
                    textElement.style.top = (initialY + deltaY) + 'px';
                }
            });
            
            document.addEventListener('mouseup', function() {
                if (isDragging && textElement) {
                    isDragging = false;
                    textElement.style.cursor = 'move';
                }
            });
            
            textElement.onclick = function() {
    selectElement(this);
    switchEditorTab('text'); // ì´ ì¤„ ì¶”ê°€
    loadTextToEditor(this);
};

            // ì—¬ê¸°ì— ì¶”ê°€
textElement.addEventListener('input', function() {
    const textContent = document.getElementById('text-content');
    if (textContent && document.getElementById('text-tab').classList.contains('active')) {
        textContent.value = this.textContent || this.innerHTML;
    }
});

textElement.addEventListener('blur', function() {
    const textContent = document.getElementById('text-content');
    if (textContent && document.getElementById('text-tab').classList.contains('active')) {
        textContent.value = this.textContent || this.innerHTML;
    }
});
            canvas.appendChild(textElement);
            
            // í…ìŠ¤íŠ¸ íƒ­ìœ¼ë¡œ ì´ë™
            switchEditorTab('text');
            
            // ìš”ì†Œ ì„ íƒ
            if (typeof selectElement === 'function') {
                selectElement(textElement);
            }
            
            console.log('í…ìŠ¤íŠ¸ ìš”ì†Œ ì¶”ê°€ ë° í…ìŠ¤íŠ¸ íƒ­ìœ¼ë¡œ ì´ë™');
        }
        
        function addQuickImage() {
            // íŒŒì¼ ì„ íƒ ë‹¤ì´ì–¼ë¡œê·¸ ì—´ê¸°
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        // ì´ë¯¸ì§€ ìš”ì†Œ ì¶”ê°€
                        const canvas = document.getElementById('canvas');
                        const imgElement = document.createElement('img');
                        imgElement.className = 'canvas-element canvas-image';
                        imgElement.src = event.target.result;
                        imgElement.style.position = 'absolute';
                        imgElement.style.left = '50px';
                        imgElement.style.top = '100px';
                        imgElement.style.width = '100px';
                        imgElement.style.height = 'auto';
                        imgElement.style.cursor = 'move';
// ë“œë˜ê·¸ ê¸°ëŠ¥ ì¶”ê°€
let isDragging = false;
let startX, startY, initialX, initialY;

imgElement.addEventListener('mousedown', function(e) {
    if (e.ctrlKey) {
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
        initialX = parseInt(this.style.left) || 0;
        initialY = parseInt(this.style.top) || 0;
        this.style.cursor = 'grabbing';
        e.preventDefault();
    }
});

document.addEventListener('mousemove', function(e) {
    if (isDragging && imgElement) {
        const deltaX = e.clientX - startX;
        const deltaY = e.clientY - startY;
        imgElement.style.left = (initialX + deltaX) + 'px';
        imgElement.style.top = (initialY + deltaY) + 'px';
    }
});

document.addEventListener('mouseup', function() {
    if (isDragging && imgElement) {
        isDragging = false;
        imgElement.style.cursor = 'move';
    }
});
imgElement.onclick = function() {
    selectElement(this);
    switchEditorTab('image'); // ì´ ì¤„ ì¶”ê°€
};
                        
                        canvas.appendChild(imgElement);
                        
                        // ìš”ì†Œ ì„ íƒ
                        if (typeof selectElement === 'function') {
                            selectElement(imgElement);
                        }
                        
                        console.log('ì´ë¯¸ì§€ ìš”ì†Œ ì¶”ê°€');
                    };
                    reader.readAsDataURL(file);
                }
            };
            
            input.click();
            
            // ì´ë¯¸ì§€ íƒ­ìœ¼ë¡œ ì´ë™
            switchEditorTab('image');
            console.log('ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ ë° ì´ë¯¸ì§€ íƒ­ìœ¼ë¡œ ì´ë™');
        }
        
        function addQuickShape(shapeType) {
            // ë„í˜• ìš”ì†Œ ì¶”ê°€
            const canvas = document.getElementById('canvas');
            const shapeElement = document.createElement('div');
            shapeElement.className = 'canvas-element canvas-shape';
            shapeElement.style.position = 'absolute';
            shapeElement.style.left = '50px';
            shapeElement.style.top = '150px';
            shapeElement.style.width = '80px';
            shapeElement.style.height = '80px';
            shapeElement.style.cursor = 'move';
            
            if (shapeType === 'circle') {
                shapeElement.style.borderRadius = '50%';
                shapeElement.style.backgroundColor = '#667eea';
            } else if (shapeType === 'rectangle') {
                shapeElement.style.backgroundColor = '#667eea';
            }
// ë“œë˜ê·¸ ê¸°ëŠ¥ ì¶”ê°€
let isDragging = false;
let startX, startY, initialX, initialY;

shapeElement.addEventListener('mousedown', function(e) {
    if (e.ctrlKey) {
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
        initialX = parseInt(this.style.left) || 0;
        initialY = parseInt(this.style.top) || 0;
        this.style.cursor = 'grabbing';
        e.preventDefault();
    }
});

document.addEventListener('mousemove', function(e) {
    if (isDragging && shapeElement) {
        const deltaX = e.clientX - startX;
        const deltaY = e.clientY - startY;
        shapeElement.style.left = (initialX + deltaX) + 'px';
        shapeElement.style.top = (initialY + deltaY) + 'px';
    }
});

document.addEventListener('mouseup', function() {
    if (isDragging && shapeElement) {
        isDragging = false;
        shapeElement.style.cursor = 'move';
    }
});
            
shapeElement.onclick = function() {
    selectElement(this);
    switchEditorTab('shape'); // ì´ ì¤„ ì¶”ê°€
};
            
            canvas.appendChild(shapeElement);
            
            // ë„í˜• íƒ­ìœ¼ë¡œ ì´ë™
            switchEditorTab('shape');
            
            // ìš”ì†Œ ì„ íƒ
            if (typeof selectElement === 'function') {
                selectElement(shapeElement);
            }
            
            console.log(`${shapeType} ë„í˜• ì¶”ê°€ ë° ë„í˜• íƒ­ìœ¼ë¡œ ì´ë™`);
        }
        
        function addQuickVideo() {
            // ë™ì˜ìƒ íŒŒì¼ ì„ íƒ ë‹¤ì´ì–¼ë¡œê·¸ ì—´ê¸°
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'video/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    // ë™ì˜ìƒ ìš”ì†Œ ì¶”ê°€
                    const canvas = document.getElementById('canvas');
                    const videoElement = document.createElement('video');
                    videoElement.className = 'canvas-element canvas-video';
                    videoElement.src = URL.createObjectURL(file);
                    videoElement.controls = true;
                    videoElement.style.position = 'absolute';
                    videoElement.style.left = '50px';
                    videoElement.style.top = '200px';
                    videoElement.style.width = '120px';
                    videoElement.style.height = 'auto';
                    videoElement.style.cursor = 'move';
// ë“œë˜ê·¸ ê¸°ëŠ¥ ì¶”ê°€
let isDragging = false;
let startX, startY, initialX, initialY;

videoElement.addEventListener('mousedown', function(e) {
    if (e.ctrlKey) {
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
        initialX = parseInt(this.style.left) || 0;
        initialY = parseInt(this.style.top) || 0;
        this.style.cursor = 'grabbing';
        e.preventDefault();
    }
});

document.addEventListener('mousemove', function(e) {
    if (isDragging && videoElement) {
        const deltaX = e.clientX - startX;
        const deltaY = e.clientY - startY;
        videoElement.style.left = (initialX + deltaX) + 'px';
        videoElement.style.top = (initialY + deltaY) + 'px';
    }
});

document.addEventListener('mouseup', function() {
    if (isDragging && videoElement) {
        isDragging = false;
        videoElement.style.cursor = 'move';
    }
});
                    videoElement.onclick = function() {
    selectElement(this);
    switchEditorTab('video'); // ì´ ì¤„ ì¶”ê°€
};
                    
                    canvas.appendChild(videoElement);
                    
                    // ìš”ì†Œ ì„ íƒ
                    if (typeof selectElement === 'function') {
                        selectElement(videoElement);
                    }
                    
                    console.log('ë™ì˜ìƒ ìš”ì†Œ ì¶”ê°€');
                }
            };
            
            input.click();
            
            // ë™ì˜ìƒ íƒ­ìœ¼ë¡œ ì´ë™
            switchEditorTab('video');
            console.log('ë™ì˜ìƒ íŒŒì¼ ì„ íƒ ë° ë™ì˜ìƒ íƒ­ìœ¼ë¡œ ì´ë™');
        }
        
        function addQuickAudio() {
            // ìŒì„± íŒŒì¼ ì„ íƒ ë‹¤ì´ì–¼ë¡œê·¸ ì—´ê¸°
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'audio/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    // ìŒì„± ìš”ì†Œ ì¶”ê°€ (í™”ë©´ì—ëŠ” ë³´ì´ì§€ ì•ŠëŠ” ì»¨íŠ¸ë¡¤ëŸ¬)
                    const canvas = document.getElementById('canvas');
                    const audioElement = document.createElement('audio');
                    audioElement.className = 'canvas-element canvas-audio';
                    audioElement.src = URL.createObjectURL(file);
                    audioElement.controls = true;
                    audioElement.style.position = 'absolute';
                    audioElement.style.left = '50px';
                    audioElement.style.top = '250px';
                    audioElement.style.width = '200px';
                    audioElement.style.cursor = 'move';
// ë“œë˜ê·¸ ê¸°ëŠ¥ ì¶”ê°€
let isDragging = false;
let startX, startY, initialX, initialY;

audioElement.addEventListener('mousedown', function(e) {
    if (e.ctrlKey) {
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
        initialX = parseInt(this.style.left) || 0;
        initialY = parseInt(this.style.top) || 0;
        this.style.cursor = 'grabbing';
        e.preventDefault();
    }
});

document.addEventListener('mousemove', function(e) {
    if (isDragging && audioElement) {
        const deltaX = e.clientX - startX;
        const deltaY = e.clientY - startY;
        audioElement.style.left = (initialX + deltaX) + 'px';
        audioElement.style.top = (initialY + deltaY) + 'px';
    }
});

document.addEventListener('mouseup', function() {
    if (isDragging && audioElement) {
        isDragging = false;
        audioElement.style.cursor = 'move';
    }
});
                    audioElement.onclick = function() {
    selectElement(this);
    switchEditorTab('audio'); // ì´ ì¤„ ì¶”ê°€
};
                    
                    canvas.appendChild(audioElement);
                    
                    // ìš”ì†Œ ì„ íƒ
                    if (typeof selectElement === 'function') {
                        selectElement(audioElement);
                    }
                    
                    console.log('ìŒì„± ìš”ì†Œ ì¶”ê°€');
                }
            };
            
            input.click();
            
            // ìŒì„± íƒ­ìœ¼ë¡œ ì´ë™
            switchEditorTab('audio');
            console.log('ìŒì„± íŒŒì¼ ì„ íƒ ë° ìŒì„± íƒ­ìœ¼ë¡œ ì´ë™');
        }
        
        // ========== í…ìŠ¤íŠ¸ í¬ê¸° ì¡°ì ˆ í•¨ìˆ˜ë“¤ (ìƒˆë¡œ ì¶”ê°€) ==========
        function updateTextWidth(width) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-text')) return;
            
            selectedElement.style.width = width + 'px';
            document.getElementById('text-width-value').textContent = width + 'px';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }
        
        function updateTextHeight(height) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-text')) return;
            
            selectedElement.style.height = height + 'px';
            document.getElementById('text-height-value').textContent = height + 'px';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }
        
        function updateTextPosition() {
            if (!selectedElement || !selectedElement.classList.contains('canvas-text')) return;
            
            const x = document.getElementById('text-x').value;
            const y = document.getElementById('text-y').value;
            
            selectedElement.style.left = x + 'px';
            selectedElement.style.top = y + 'px';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }
        
        // ========== ì´ë¯¸ì§€ ìœ„ì¹˜ ì¡°ì ˆ í•¨ìˆ˜ (ìƒˆë¡œ ì¶”ê°€) ==========
        function updateImageWidth(width) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-image')) return;
            
            selectedElement.style.width = width + 'px';
            document.getElementById('image-width-value').textContent = width + 'px';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }
        
        function updateImageHeight(height) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-image')) return;
            
            selectedElement.style.height = height + 'px';
            document.getElementById('image-height-value').textContent = height + 'px';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }
        
        function updateImagePosition() {
            if (!selectedElement || !selectedElement.classList.contains('canvas-image')) return;
            
            const x = document.getElementById('image-x').value;
            const y = document.getElementById('image-y').value;
            
            selectedElement.style.left = x + 'px';
            selectedElement.style.top = y + 'px';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }
        
        // ========== ë„í˜• í¬ê¸°/ìœ„ì¹˜ ì¡°ì ˆ í•¨ìˆ˜ë“¤ (ìƒˆë¡œ ì¶”ê°€) ==========
        function updateShapeWidth(width) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-shape')) return;
            
            selectedElement.style.width = width + 'px';
            document.getElementById('shape-width-value').textContent = width + 'px';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }
        
        function updateShapeHeight(height) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-shape')) return;
            
            selectedElement.style.height = height + 'px';
            document.getElementById('shape-height-value').textContent = height + 'px';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }
        
        function updateShapePosition() {
            if (!selectedElement || !selectedElement.classList.contains('canvas-shape')) return;
            
            const x = document.getElementById('shape-x').value;
            const y = document.getElementById('shape-y').value;
            
            selectedElement.style.left = x + 'px';
            selectedElement.style.top = y + 'px';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }
        
        function updateShapeBgColor(color) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-shape')) return;
            selectedElement.style.backgroundColor = color;
            saveCanvasState();
        }
        
        function updateShapeBorderColor(color) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-shape')) return;
            selectedElement.style.borderColor = color;
            saveCanvasState();
        }
        
        function updateShapeBorderWidth(width) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-shape')) return;
            selectedElement.style.borderWidth = width + 'px';
            selectedElement.style.borderStyle = width > 0 ? 'solid' : 'none';
            document.getElementById('shape-border-width-value').textContent = width + 'px';
            saveCanvasState();
        }
        
        function updateShapeOpacity(opacity) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-shape')) return;
            selectedElement.style.opacity = opacity / 100;
            document.getElementById('shape-opacity-value').textContent = opacity + '%';
            saveCanvasState();
        }
        
        function updateShapeRotation(angle) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-shape')) return;
            selectedElement.style.transform = `rotate(${angle}deg)`;
            document.getElementById('shape-rotation-value').textContent = angle + 'Â°';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }
        
        function rotateShape(angle) {
            if (!selectedElement || !selectedElement.classList.contains('canvas-shape')) return;
            
            const currentRotation = parseInt(document.getElementById('shape-rotation').value) || 0;
            const newRotation = (currentRotation + angle) % 360;
            
            document.getElementById('shape-rotation').value = newRotation;
            updateShapeRotation(newRotation);
        }
        
        function toggleShapeAspectRatio() {
            // ë¹„ìœ¨ ê³ ì • ê¸°ëŠ¥ êµ¬í˜„
            const btn = document.getElementById('shape-lock-ratio-btn');
            btn.classList.toggle('active');
            
            if (btn.classList.contains('active')) {
                btn.innerHTML = 'ğŸ”“ ë¹„ìœ¨í•´ì œ';
                btn.style.background = '#007bff';
            } else {
                btn.innerHTML = 'ğŸ”’ ë¹„ìœ¨ê³ ì •';
                btn.style.background = '#555';
            }
        }
        
        function resetShapeSize() {
            if (!selectedElement || !selectedElement.classList.contains('canvas-shape')) return;
            
            selectedElement.style.width = '120px';
            selectedElement.style.height = '80px';
            
            document.getElementById('shape-width').value = 120;
            document.getElementById('shape-height').value = 80;
            document.getElementById('shape-width-value').textContent = '120px';
            document.getElementById('shape-height-value').textContent = '80px';
            
            // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ì—…ë°ì´íŠ¸
            if (typeof updateResizeHandles === 'function') {
                updateResizeHandles();
            }
            
            saveCanvasState();
        }

        // ========== ì˜¤ë””ì˜¤ ê´€ë ¨ í•¨ìˆ˜ë“¤ì€ js/audio.jsì—ì„œ ë¡œë“œë©ë‹ˆë‹¤ ==========

        // ========== ë„¤ë¹„ê²Œì´ì…˜ ê¸°ëŠ¥ ì—…ë°ì´íŠ¸ ==========
        function goHome() {
            window.location.href = 'index.html';
        }
        
        function openAdmin() {
            // ê´€ë¦¬ì í˜ì´ì§€ë¡œ ì´ë™ ë˜ëŠ” ê´€ë¦¬ì íŒ¨ë„ ì—´ê¸°
            window.open('admin.html', '_blank');
        }
        
function saveProject() {
    // í”„ë¡œì íŠ¸ ì´ë¦„ ì…ë ¥ ë°›ê¸°
    let projectName = document.getElementById('project-title').textContent;
    if (projectName === 'í”„ë¡œì íŠ¸: í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸' || projectName === 'í”„ë¡œì íŠ¸: ') {
        projectName = prompt('í”„ë¡œì íŠ¸ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:', 'ìƒˆ í”„ë¡œì íŠ¸');
        if (!projectName) return;
        document.getElementById('project-title').textContent = 'í”„ë¡œì íŠ¸: ' + projectName;
    }
    
    // í˜„ì¬ í”„ë¡œì íŠ¸ ìƒíƒœ ì €ì¥
    const projectData = {
        name: projectName,
        canvas: document.getElementById('canvas').innerHTML,
        timestamp: new Date().toISOString(),
        elements: []
    };
    
    // ìº”ë²„ìŠ¤ ìš”ì†Œë“¤ ìˆ˜ì§‘
    const elements = document.querySelectorAll('.canvas-element');
    elements.forEach((element, index) => {
        projectData.elements.push({
            id: element.id,
            type: element.classList.contains('canvas-text') ? 'text' : 
                  element.classList.contains('canvas-image') ? 'image' : 
                  element.classList.contains('canvas-shape') ? 'shape' : 
                  element.classList.contains('canvas-video') ? 'video' :
                  element.classList.contains('canvas-audio') ? 'audio' : 'unknown',
            style: element.style.cssText,
            content: element.innerHTML || element.src,
            position: {
                left: element.style.left,
                top: element.style.top
            }
        });
    });
    
    // localStorageì— ì €ì¥
    localStorage.setItem('currentProject', JSON.stringify(projectData));
    
    alert(`í”„ë¡œì íŠ¸ "${projectName}"ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì €ì¥ ì‹œê°„: ` + new Date().toLocaleString());
    console.log('í”„ë¡œì íŠ¸ ì €ì¥ ì™„ë£Œ:', projectData);
}

        // ========== í”Œë ˆì´ì–´ ê¸°ëŠ¥ ==========
        let currentMode = 'edit';
        let isPlaying = false;
        let currentTime = 0;
        let totalDuration = 60;
        let playInterval = null;
        let timelineElements = [];
        
        // í¸ì§‘ ëª¨ë“œë¡œ ì „í™˜
        function switchToEditMode() {
            currentMode = 'edit';
            
            // ì¬ìƒ ì¤‘ì´ë©´ ì •ì§€
            if (isPlaying) {
                stopPlayback();
            }
            
            // UI ì—…ë°ì´íŠ¸
            document.getElementById('edit-mode-btn').classList.add('active');
            document.getElementById('player-mode-btn').classList.remove('active');
            document.getElementById('player-controls').style.display = 'none';
            
            // ìº”ë²„ìŠ¤ ìŠ¤íƒ€ì¼ ë³µêµ¬
            const canvas = document.getElementById('canvas');
            canvas.classList.remove('canvas-player-mode');
            
            // ëª¨ë“  ìš”ì†Œ í‘œì‹œ
            const elements = canvas.querySelectorAll('.canvas-element');
            elements.forEach(element => {
                element.style.display = '';
                element.style.opacity = '';
            });
            
            console.log('âœï¸ í¸ì§‘ ëª¨ë“œë¡œ ì „í™˜');
        }
        
        // í”Œë ˆì´ì–´ ëª¨ë“œë¡œ ì „í™˜
        function switchToPlayerMode() {
            currentMode = 'player';
            
            // UI ì—…ë°ì´íŠ¸
            document.getElementById('edit-mode-btn').classList.remove('active');
            document.getElementById('player-mode-btn').classList.add('active');
            document.getElementById('player-controls').style.display = 'flex';
            
            // ìº”ë²„ìŠ¤ë¥¼ í”Œë ˆì´ì–´ìš©ìœ¼ë¡œ ì„¤ì •
            const canvas = document.getElementById('canvas');
            canvas.classList.add('canvas-player-mode');
            
            // íƒ€ì„ë¼ì¸ ìš”ì†Œë“¤ ì¤€ë¹„
            prepareTimelineElements();
            
            // ì‹œì‘ ì‹œì ìœ¼ë¡œ ë¦¬ì…‹
            seekTo(0);
            
            console.log('â–¶ï¸ í”Œë ˆì´ì–´ ëª¨ë“œë¡œ ì „í™˜');
        }
        
        // íƒ€ì„ë¼ì¸ ìš”ì†Œë“¤ ì¤€ë¹„
        function prepareTimelineElements() {
            const canvas = document.getElementById('canvas');
            const elements = canvas.querySelectorAll('.canvas-element:not(.canvas-background-template)');
            
            timelineElements = [];
            
            elements.forEach((element, index) => {
                const timelineItem = {
                    element: element,
                    startTime: index * 3, // 3ì´ˆì”© ê°„ê²©
                    endTime: totalDuration,
                    animation: 'fadeIn',
                    duration: 0.5
                };
                
                timelineElements.push(timelineItem);
                
                // ì´ˆê¸°ì—ëŠ” ëª¨ë“  ìš”ì†Œ ìˆ¨ê¹€
                element.style.display = 'none';
                element.style.opacity = '0';
            });
            
            console.log(`ğŸ“‹ íƒ€ì„ë¼ì¸ ìš”ì†Œ ${timelineElements.length}ê°œ ì¤€ë¹„ ì™„ë£Œ`);
        }
        
        // ì¬ìƒ/ì¼ì‹œì •ì§€ í† ê¸€
        function togglePlayPause() {
            if (isPlaying) {
                pausePlayback();
            } else {
                startPlayback();
            }
        }
        
        // ì¬ìƒ ì‹œì‘
        function startPlayback() {
            if (currentMode !== 'player') return;
            
            isPlaying = true;
            document.getElementById('play-pause-btn').innerHTML = 'â¸ï¸';
            
            playInterval = setInterval(() => {
                currentTime += 1/30; // 30fps
                
                if (currentTime >= totalDuration) {
                    const loopBtn = document.getElementById('loop-btn');
                    if (loopBtn && loopBtn.classList.contains('active')) {
                        seekTo(0);
                    } else {
                        stopPlayback();
                    }
                    return;
                }
                
                updateTimeline();
                updateTimeDisplay();
                updateTimelineSlider();
                
            }, 1000/30);
            
            console.log('â–¶ï¸ ì¬ìƒ ì‹œì‘');
        }
        
        // ì¬ìƒ ì¼ì‹œì •ì§€
        function pausePlayback() {
            isPlaying = false;
            document.getElementById('play-pause-btn').innerHTML = 'â–¶ï¸';
            
            if (playInterval) {
                clearInterval(playInterval);
                playInterval = null;
            }
            
            console.log('â¸ï¸ ì¬ìƒ ì¼ì‹œì •ì§€');
        }
        
        // ì¬ìƒ ì •ì§€
        function stopPlayback() {
            pausePlayback();
            seekTo(0);
            console.log('â¹ï¸ ì¬ìƒ ì •ì§€');
        }
        
        // íŠ¹ì • ì‹œì ìœ¼ë¡œ ì´ë™
        function seekTo(time) {
            currentTime = Math.max(0, Math.min(totalDuration, time));
            updateTimeline();
            updateTimeDisplay();
            updateTimelineSlider();
        }
        
        // íƒ€ì„ë¼ì¸ ì—…ë°ì´íŠ¸
        function updateTimeline() {
            timelineElements.forEach(item => {
                const { element, startTime, endTime, animation, duration } = item;
                
                if (currentTime >= startTime && currentTime <= endTime) {
                    if (element.style.display === 'none') {
                        element.style.display = '';
                        animateElement(element, animation, duration);
                    }
                } else {
                    element.style.display = 'none';
                    element.style.opacity = '0';
                }
            });
        }
        
        // ìš”ì†Œ ì• ë‹ˆë©”ì´ì…˜
        function animateElement(element, animationType, duration) {
            element.style.transition = `all ${duration}s ease`;
            
            switch(animationType) {
                case 'fadeIn':
                    element.style.opacity = '0';
                    setTimeout(() => {
                        element.style.opacity = '1';
                    }, 10);
                    break;
                default:
                    element.style.opacity = '1';
            }
        }
        
        // ì‹œê°„ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateTimeDisplay() {
            const current = formatTime(currentTime);
            const total = formatTime(totalDuration);
            document.getElementById('time-display').innerHTML = `${current} / ${total}`;
        }
        
        // íƒ€ì„ë¼ì¸ ìŠ¬ë¼ì´ë” ì—…ë°ì´íŠ¸
        function updateTimelineSlider() {
            document.getElementById('timeline-slider').value = currentTime;
        }
        
        // ì‹œê°„ í¬ë§·íŒ…
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        // ì¬ìƒ ì†ë„ ë³€ê²½
        function changePlaybackSpeed(speed) {
            console.log(`âš¡ ì¬ìƒ ì†ë„: ${speed}x`);
        }
        
        // ë³¼ë¥¨ ì¡°ì ˆ
        function changeVolume(volume) {
            document.getElementById('volume-value').innerHTML = `${volume}%`;
            console.log(`ğŸ”Š ë³¼ë¥¨: ${volume}%`);
        }
        
        // ë°˜ë³µ ì¬ìƒ í† ê¸€
        function toggleLoop() {
            const loopBtn = document.getElementById('loop-btn');
            loopBtn.classList.toggle('active');
            
            if (loopBtn.classList.contains('active')) {
                loopBtn.style.background = '#007bff';
                loopBtn.innerHTML = 'ğŸ”„ ë°˜ë³µ ON';
            } else {
                loopBtn.style.background = '#555';
                loopBtn.innerHTML = 'ğŸ”„ ë°˜ë³µ';
            }
        }
        
        // ì „ì²´í™”ë©´ í† ê¸€
        function toggleFullscreen() {
            const canvas = document.getElementById('canvas');
            
            if (!document.fullscreenElement) {
                canvas.requestFullscreen().then(() => {
                    console.log('â›¶ ì „ì²´í™”ë©´ ëª¨ë“œ');
                }).catch(err => {
                    console.error('ì „ì²´í™”ë©´ ì‹¤íŒ¨:', err);
                });
            } else {
                document.exitFullscreen().then(() => {
                    console.log('â›· ì „ì²´í™”ë©´ í•´ì œ');
                }).catch(err => {
                    console.error('ì „ì²´í™”ë©´ í•´ì œ ì‹¤íŒ¨:', err);
                });
            }
        }
        
        // ë™ì˜ìƒ ë Œë”ë§
        function renderVideo() {
            if (!confirm('í˜„ì¬ í¸ì§‘ ë‚´ìš©ì„ ë™ì˜ìƒìœ¼ë¡œ ë Œë”ë§í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }
            
            const renderBtn = event.target;
            const originalText = renderBtn.innerHTML;
            renderBtn.innerHTML = 'ğŸ¬ ë Œë”ë§ ì¤‘...';
            renderBtn.disabled = true;
            
            setTimeout(() => {
                alert(`ğŸ‰ ë Œë”ë§ ì™„ë£Œ!

ì¶œë ¥ ì„¤ì •:
- í•´ìƒë„: 1080x1920 (ì„¸ë¡œí˜• ì‡¼ì¸ )  
- í¬ë§·: MP4 (H.264)
- í”„ë ˆì„ìœ¨: 30fps
- ê¸¸ì´: ${formatTime(totalDuration)}

íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œ í´ë”ì— ì €ì¥ë©ë‹ˆë‹¤.`);
                
                renderBtn.innerHTML = originalText;
                renderBtn.disabled = false;
                
                console.log('ğŸ¬ ë™ì˜ìƒ ë Œë”ë§ ì™„ë£Œ');
            }, 3000);
        }
        
        // ========== í…œí”Œë¦¿ ë° ê¸°íƒ€ ë¡œë“œ ==========
        
        // ë¯¸ë””ì–´ íŒ¨ë„ ë¡œë“œ
        fetch('templates/media-panel.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('media-sources').innerHTML = html;
                console.log('ğŸ“· ë¯¸ë””ì–´ íŒ¨ë„ ë¡œë“œ ì™„ë£Œ');
            })
            .catch(error => console.error('ë¯¸ë””ì–´ íŒ¨ë„ ë¡œë“œ ì‹¤íŒ¨:', error));
        
        // ì˜¤ë””ì˜¤ íŒ¨ë„ ë¡œë“œ
        fetch('templates/audio-panel.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('audio-sources').innerHTML = html;
                console.log('ğŸµ ì˜¤ë””ì˜¤ íŒ¨ë„ ë¡œë“œ ì™„ë£Œ');
            })
            .catch(error => console.error('ì˜¤ë””ì˜¤ íŒ¨ë„ ë¡œë“œ ì‹¤íŒ¨:', error));

        // í…œí”Œë¦¿ íŒ¨ë„ ë¡œë“œ
        fetch('templates/template-panel.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('template-sources').innerHTML = html;
                console.log('ğŸ¨ í…œí”Œë¦¿ íŒ¨ë„ ë¡œë“œ ì™„ë£Œ');
            })
            .catch(error => console.error('í…œí”Œë¦¿ íŒ¨ë„ ë¡œë“œ ì‹¤íŒ¨:', error));
            
        // ì €ì¥ëœ í”„ë¡œì íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadProject() {
            const saved = localStorage.getItem('currentProject');
            if (saved) {
                const projectData = JSON.parse(saved);
                
                // í”„ë¡œì íŠ¸ ì œëª© ë³µì›
                document.getElementById('project-title').textContent = 'í”„ë¡œì íŠ¸: ' + projectData.name;
                
                // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
                const canvas = document.getElementById('canvas');
                canvas.innerHTML = '';
                
                // ìš”ì†Œë“¤ ë³µì›
                projectData.elements.forEach(elementData => {
                    let element;
                    
                    if (elementData.type === 'text') {
                        element = document.createElement('div');
                        element.className = 'canvas-element canvas-text';
                        element.innerHTML = elementData.content;
                        element.contentEditable = true;
                    } else if (elementData.type === 'image') {
                        element = document.createElement('img');
                        element.className = 'canvas-element canvas-image';
                        element.src = elementData.content;
                    } else if (elementData.type === 'shape') {
                        element = document.createElement('div');
                        element.className = 'canvas-element canvas-shape';
                    }
                    
                    if (element) {
                        element.id = elementData.id;
                        element.style.cssText = elementData.style;
                        element.style.left = elementData.position.left;
                        element.style.top = elementData.position.top;
                        element.style.position = 'absolute';
                        element.style.cursor = 'move';
                        
                        element.onclick = function() {
                            selectElement(this);
                        };
                        
                        canvas.appendChild(element);
                    }
                });
                
                console.log(`ğŸ“‚ í”„ë¡œì íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ: ${projectData.elements.length}ê°œ ìš”ì†Œ`);
                return true;
            }
            return false;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ì‹œ ì´ˆê¸°í™” ë° ìë™ ë¶ˆëŸ¬ì˜¤ê¸°
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ¬ í¸ì§‘ê¸° ë¡œë“œ ì™„ë£Œ - íƒ­ ì‹œìŠ¤í…œ ì ìš©, í”Œë ˆì´ì–´ ê¸°ëŠ¥ ë‚´ì¥, í¬ê¸° ì¡°ì ˆ ê¸°ëŠ¥ ì¶”ê°€');
            
            // ì €ì¥ëœ í”„ë¡œì íŠ¸ ìë™ ë¶ˆëŸ¬ì˜¤ê¸°
            if (loadProject()) {
                console.log('âœ… ì €ì¥ëœ í”„ë¡œì íŠ¸ ìë™ ë³µì›ë¨');
            }
        });
    </script>
</body>
</html>